(this["webpackJsonpsenso-trail-app"]=this["webpackJsonpsenso-trail-app"]||[]).push([[0],{65:function(e,t,n){},75:function(e,t,n){e.exports=n(97)},90:function(e,t,n){},91:function(e,t,n){},92:function(e,t,n){},93:function(e,t,n){},94:function(e,t,n){},95:function(e,t,n){},96:function(e,t,n){},97:function(e,t,n){"use strict";n.r(t);var a=n(26);Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=Object(a.a)(this);try{for(r.s();!(e=r.n()).done;){var o=e.value;o instanceof Array&&t>0?o.flat(t-1,n):n.push(o)}}catch(i){r.e(i)}finally{r.f()}return n}});var r=n(0),o=n.n(r),i=n(44),c=n.n(i),u={trailname:"main",sources:{trail:"/",audio:"/",image:"/"}};var s=u,l=n(11),d=n(40),f=n(67),m=n(15),p=n(17),g=n(64),v=n(61),O=n(68),E=n.n(O),h=n(20),b=n(2),_={byUuid:{}};function S(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_MESSAGE":return{byUuid:Object(b.a)({},e.byUuid,Object(h.a)({},t.uuid,{messageType:t.messageType,text:t.text,timestamp:t.timestamp,uuid:t.uuid}))};case"HIDE_MESSAGE":return{byUuid:Object(b.a)({},e.byUuid,Object(h.a)({},t.uuid,Object(b.a)({},e.byUuid[t.uuid],{hide:!0})))};default:return e}}var j={messageQueue:[],jsonFile:void 0,lastRead:0,loading:!1,chatOptions:[{text:"Start",index:-1}]};function A(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_CHAT_MESSAGE":return Object(b.a)({},e,{messageQueue:e.messageQueue.concat([{message:t.message,sender:t.sender,read:!1,tags:Object(b.a)({},t.tags)}])});case"MARK_MESSAGE_READ":return Object(b.a)({},e,{lastRead:t.index,messageQueue:e.messageQueue.map((function(e,n){return n<=t.index&&(e.read=!0),e}))});case"SET_CHAT_OPTIONS":return Object(b.a)({},e,{chatOptions:t.options.map((function(e){return Object(b.a)({},e)}))});case"LOAD_INK_JSON_START":return Object(b.a)({},e,{loading:!0});case"LOAD_INK_JSON_SUCCESS":return Object(b.a)({},e,{loading:!1,jsonFile:{filename:t.filename,data:t.json}});case"LOAD_INK_JSON_FAIL":return Object(b.a)({},e,{loading:!1,jsonFile:void 0});default:return e}}var T={stations:{},serviceWorkerActive:!1,loading:!1};function y(e,t){switch(t.resourceType){case"RESOURCE_TYPE_STATION":return Object(b.a)({},e,{stations:Object(b.a)({},e.stations,{},t.resource)});default:return e}}var N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOAD_RESOURCE_START":return Object(b.a)({},e,{loading:!0});case"LOAD_RESOURCE_FAIL":return Object(b.a)({},e,{loading:!1});case"SET_SW_ACTIVE":return Object(b.a)({},e,{serviceWorkerActive:t.active});case"LOAD_RESOURCE_SUCCESS":return y(Object(b.a)({},e,{loading:!1}),t);case"ADD_RESOURCE":return y(e,t);default:return e}},w={currentLocation:{},currentSite:{uuid:"",siteType:"none"}};var R=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CURRENT_SITE":return Object(b.a)({},e,{currentSite:{uuid:t.uuid,siteType:t.siteType}});case"GEOLOCATION_CHANGED":return Object(b.a)({},e,{currentLocation:{latitude:t.latitude,longitude:t.longitude}});default:return e}},C={allowed:!1};function I(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_NOTIFICATION_PERMISSION":return Object(b.a)({},e,{allowed:t.allowed});default:return e}}var D={messages:_,chat:j,notification:C,resources:T,geolocation:w};function x(e){return Object(p.c)({router:Object(d.b)(e),messages:S,chat:A,notification:I,resources:N,geolocation:R})}var k=n(103),L=n(102),M=n(28),P=n(49),G=n(100),U=n(104),z=n(71),F=n(70),W=n(32),H=n.n(W);function J(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return null===a&&(a=Date.now()),{type:"ADD_MESSAGE",messageType:e,text:t,timestamp:a,uuid:n}}function K(e){return{type:"HIDE_MESSAGE",uuid:e}}var Y=[{trigger:"LOAD_RESOURCE_FAIL",type:"MESSAGE_TYPE_ERROR",message:"Fehler: Resourcen konnten nicht gelanden werden"},{trigger:"LOAD_INK_JSON_FAIL",type:"MESSAGE_TYPE_ERROR",message:"Fehler: Die Story konnte nicht gelanden werden"}];var B=k.a.apply(void 0,[function(e){return e.pipe(Object(F.a)("ADD_MESSAGE"),Object(G.a)((function(e){return Object(z.a)(K(e.uuid)).pipe(Object(U.a)(3e3))})))}].concat(Object(M.a)(Y.map((function(e){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:H.a;return function(n,a){return n.pipe(Object(F.a)(e.trigger),Object(P.a)((function(n){var a=t();return J(e.type,e.message,a)})))}}(e)}))))),Q=n(12),V=n.n(Q),X=n(22),q=n(72),$=n(101);function Z(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return{type:"ADD_CHAT_MESSAGE",message:e,sender:t,tags:n}}function ee(e){return{type:"SET_CHAT_OPTIONS",options:e}}function te(e){return{type:"CHOOSE_CHAT_OPTION",option:e}}function ne(e,t){return{type:"LOAD_INK_JSON_SUCCESS",filename:e,json:t}}function ae(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return{type:"LOAD_RESOURCE_SUCCESS",resource:e,resourceType:t}}function re(e){return{type:"PRELOAD_CACHE_DATA_FAIL",msg:e}}var oe=Object(k.a)((function(e,t,n){var a=n.getCurrentStory;return n.extractTags,e.pipe(Object(F.a)("CHOOSE_CHAT_OPTION"),Object(G.a)((function(e){var t=a();if(e.option<0){var n=t.Continue();return Object(z.a)(Z(n,"SENDER_IS_SENSI",{}))}return t.currentChoices.length>0&&t.ChooseChoiceIndex(e.option),Object(z.a)(Z(t.Continue(),"SENDER_IS_PLAYER"))})))}),(function(e,t,n){var a=n.fetchJSON,r=n.initStory;return e.pipe(Object(F.a)("LOAD_INK_JSON_START"),Object(G.a)(function(){var e=Object(X.a)(V.a.mark((function e(n){var o,i;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.value.chat.jsonFile||t.value.chat.jsonFile.filename!==n.filename){e.next=3;break}return r(t.value.chat.jsonFile.data),e.abrupt("return",ne(n.filename,t.value.chat.jsonFile.data));case 3:return o=n.filename,e.next=6,a(o);case 6:return i=e.sent,r(i),console.log("story loaded: ",n.filename),e.abrupt("return",ne(n.filename,i));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Object($.a)((function(e){return[{type:"LOAD_INK_JSON_FAIL",filename:t}];var t})))}),(function(e,t,n){var a=n.getCurrentStory,r=n.extractTags;return e.pipe(Object(F.a)("ADD_CHAT_MESSAGE"),Object(G.a)((function(e){var t=a();if(!t)return q.a;if(t.canContinue){var n=t.Continue(),o=r(t.currentTags);return Object(z.a)(Z(n,"SENDER_IS_SENSI",o)).pipe(Object(U.a)(1e3))}if(t.currentChoices.length>0){var i=t.currentChoices.map((function(e){return{text:e.text,index:e.index}}));return Object(z.a)(ee(i))}return Object(z.a)(ee([]))})))}),(function(e,t,n){var a=n.getCurrentStory,r=n.getGlobalTags;return e.pipe(Object(F.a)("LOAD_INK_JSON_SUCCESS"),Object(G.a)((function(e){var t=a();console.log(t);var n,o,i,c=r(t.globalTags);if(console.log("globalTags:",c),c){var u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:H.a,n={};return e.forEach((function(e){var a=t();n[a]=Object(b.a)({},e,{id:t})})),n}(c.stations),s=[].concat(Object(M.a)(c.audio),Object(M.a)(c.images));return[(i=s,{type:"PRELOAD_CACHE_DATA",urls:i}),(n=u,o="RESOURCE_TYPE_STATION",{type:"ADD_RESOURCE",resource:n,resourceType:o}),te(-1)]}return console.error("could not load global Tags"),[te(-1)]})))}),(function(e,t,n){var a=n.getCurrentStory;return e.pipe(Object(F.a)("JUMP_TO_SCENE"),Object(G.a)((function(e){var t=a();return t?(t.ChoosePathString(e.sceneId),[te(-1)]):q.a})))}));function ie(e,t,n,a){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:10;return ce(e,t,n,a)<r}function ce(e,t,n,a){e=se(e),t=se(t);var r=(n=se(n))-e,o=(a=se(a))-t,i=(e+n)/2,c=Math.cos(i)*o;return c*=c,6371009*Math.sqrt(r*r+c)}var ue=Math.PI/180;function se(e){return ue*e}var le=Object(k.a)((function(e,t){return e.pipe(Object(F.a)("GEOLOCATION_CHANGED"),Object(G.a)((function(e){var n,a,r,o=t.value.resources.stations,i=t.value.geolocation.currentSite;for(var c in o)if(c!==i.uuid&&ie(e.latitude,e.longitude,o[c].latitude,o[c].longitude))return[(r=o[c].station,{type:"JUMP_TO_SCENE",sceneId:r}),(n=c,a="stations",{type:"SET_CURRENT_SITE",uuid:n,siteType:a})];return q.a})))}),(function(e,t){return e.pipe(Object(F.a)("GEOLOCATION_ERROR"),Object(G.a)((function(e){console.log(e),console.log("GEOLOCATION_ERROR");var t=H()(),n="Geolocation Error. Code: ".concat(e.error.code," msg: ").concat(e.error.message);return Object(z.a)(J("MESSAGE_TYPE_ERROR",n,t))})))})),de=n(73);function fe(e){var t,n={},r=Object(a.a)(e);try{for(r.s();!(t=r.n()).done;){var o=t.value;n[o.uuid]=o}}catch(i){r.e(i)}finally{r.f()}return n}var me=n(9);var pe=Object(me.a)([function(e){return e.resources.serviceWorkerActive}],(function(e){return e}));var ge=Object(k.a)((function(e,t,n){var a=n.fetchJSON;return e.pipe(Object(F.a)("LOAD_RESOURCE_START"),Object(de.a)(function(){var e=Object(X.a)(V.a.mark((function e(t){var n,r,o;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="/SENSO-Trail-App/json/"+t.source,e.next=3,a(n);case 3:return r=e.sent,o=fe([r]),e.abrupt("return",ae(o));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Object($.a)((function(e){return[{type:"LOAD_RESOURCE_FAIL"}]})))}),(function(e,t,n){var a=n.fetch;return e.pipe(Object(F.a)("PRELOAD_CACHE_DATA"),Object(de.a)(function(){var e=Object(X.a)(V.a.mark((function e(n){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!pe(t.value)){e.next=6;break}return window.navigator.serviceWorker.controller.postMessage({type:"NATURE40_ADD_ROUTE",routes:n.urls}),e.next=5,Promise.all(n.urls.map((function(e){return console.log("fetching ",e),a(e)})));case 5:return e.abrupt("return",{type:"PRELOAD_CACHE_DATA_FINISED",urls:n.urls});case 6:return e.abrupt("return",re("No Service Worker active"));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Object($.a)((function(e){return[re(e)]})))})),ve=n(98);var Oe=Object(me.a)([function(e){return e.notification.allowed}],(function(e){return e}));var Ee=[{trigger:"ADD_CHAT_MESSAGE",format:function(e){return"".concat(e.sender,": ").concat(e.message)},filterNotifications:function(e,t){return"/chat"!==t.router.location.pathname&&"SENDER_IS_PLAYER"!==e.sender}}];var he=k.a.apply(void 0,[function(e,t,n){var a=n.notify,r=n.logError;return e.pipe(Object(F.a)("EMIT_NOTIFICATION"),Object(ve.a)((function(){return Oe(t.value)})),Object(G.a)((function(e){return a(e.message),[]})),Object($.a)((function(e){return r("[ERROR]: ",e),[]})))}].concat(Object(M.a)(Ee.map((function(e){var t=e.trigger,n=e.format,a=e.filterNotifications;return function(e,r){return e.pipe(Object(F.a)(t),Object(ve.a)((function(e){return a(e,r.value)})),Object(P.a)((function(e){return{type:"EMIT_NOTIFICATION",message:n(e)}})))}})))));function be(e){return _e.apply(this,arguments)}function _e(){return(_e=Object(X.a)(V.a.mark((function e(t){var n,a,r,o,i=arguments;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]?i[1]:{},"/SENSO-Trail-App/json/activities.json"!==t){e.next=3;break}return e.abrupt("return",Se(n));case 3:return a={headers:{Accept:"application/json"},method:"GET"},e.next=6,window.fetch(t,a);case 6:return r=e.sent,e.next=9,r.json();case 9:if(o=e.sent,!("uuids"in n)){e.next=12;break}return e.abrupt("return",o.filter((function(e){return n.uuids.includes(e.uuid)})));case 12:return e.abrupt("return",o);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Se(e){return je.apply(this,arguments)}function je(){return(je=Object(X.a)(V.a.mark((function e(t){var n,a,r,o,i;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.uuids,a={headers:{Accept:"application/json"},method:"GET"},r=["/SENSO-Trail-App/json/textActivity.json","/SENSO-Trail-App/json/imageActivity.json","/SENSO-Trail-App/json/multiChoiceActivity.json"],e.next=5,Promise.all(r.map((function(e){return window.fetch(e,a)})));case 5:return o=e.sent,e.next=8,Promise.all(o.map((function(e){return e.json()})));case 8:return i=e.sent,e.abrupt("return",i.flat().filter((function(e){return n.includes(e.uuid)})));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ae,Te=n(74);function ye(e){return Ae=new Te.Story(e)}function Ne(){return Ae}function we(e){var t={},n=[];return e.forEach((function(e){var a=e.split(":");switch(a[0]){case"audio":t.audio=s.sources.audio+a[1].trim();break;case"image":"images"in t||(t.images=[]),t.images.push(function(e){var t=e.split(" ");return{src:s.sources.image+t[0],alt:t.length>1&&""!==t[1]?t[1]:"Bild"}}(a[1].trim()));break;default:n.push(a.join(":"))}})),n.length>0&&(t.other=n),t}function Re(e){var t={},n=[],a=[];return e.forEach((function(e){var r=e.split(":");switch(console.log(r),r[0]){case"station":a.push(function(e){console.log("extractStationData"),console.log(e);var t=e.split(" ");return console.log(t),{station:t[0],latitude:t[1],longitude:t[2]}}(r[1]));break;case"audio":"audio"in t||(t.audio=[]),t.audio.push(s.sources.audio+r[1].trim());break;case"image":"images"in t||(t.images=[]),t.images.push(s.sources.image+r[1].trim());break;default:n.push(r.join(":"))}})),a.length>0&&(t.stations=[].concat(a)),n.length>0&&(t.other=[].concat(n)),t}function Ce(e){if("Notification"in window){if("granted"===window.Notification.permission){console.log("notify");var t=new Notification(e);console.log(t)}else if("denied"!==window.Notification.permission)throw console.error("PERM NOT SET"),new Error("Notification Permission not set")}else console.error("This browser does not support desktop notification")}var Ie=Object(k.a)(B,oe,le,ge,he),De=function(){return Object(L.a)({dependencies:{fetchJSON:be,fetch:window.fetch,getCurrentStory:Ne,initStory:ye,extractTags:we,getGlobalTags:Re,logError:function(e){return console.error(e)},notify:Ce}})},xe=Ie,ke=Object(m.a)({basename:"/SENSO-Trail-App"}),Le="undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||p.d;n(90);var Me=n(5),Pe=n(25);function Ge(){return(Ge=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Ue(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var ze=o.a.createElement("path",{d:"M51.829 27.231L39.016 47.485l3.79 1.896-7.56 11.117 6.371.455-8.821 15.68 5.257 3.346-14.276 20.492 7.097 1.978-12.376 18.977 5.14 1.87-9.575 15.046 5.983.5-17.234 20.27 10.016 2.75 31.366 2.43-1.009 11.677h17.192l-1.005-11.629 31.041-3.654 11.164.688-17.972-22.54 5.894-.492-9.574-15.046 5.156-1.876-13.468-21.162 7.862-.232L65.51 79.98l5.224-3.326-7.827-12.925 5.725-2.634-9.45-12.562 4.894-1.253-6.933-7.974 1.55-2.204zm167.607.099l-12.54 19.823 3.71 1.856-7.398 10.88 6.234.444-8.633 15.345 5.145 3.274-13.97 20.055 6.945 1.936-12.114 18.573 5.03 1.829-9.37 14.726 5.856.488-16.866 19.84 9.803 2.69 30.697 2.377-.989 11.428h16.825l-.984-11.38 30.38-3.578 10.925.674-17.588-22.058 5.769-.48-9.371-14.727 5.047-1.835-13.18-20.711 7.693-.227-13.668-19.62 5.113-3.255-7.66-12.65 5.604-2.576-9.25-12.294 4.79-1.226-6.785-7.804 1.517-2.157zm-20.19 11.522l-1.963 2.825.57.812-2.26 2.6 1.7.435-3.43 4.558 2 .92-2.819 4.654 1.884 1.199-.85 1.218 1.32 2.087-2.476 1.239 5.596 8.23-4.513.322 3.63 6.454 7.841-13.94-6.614-.472 5.607-8.245-2.196-3.906 2.21-.158-2.568-3.775 1.365-.683zm-99.699 3.444l-1.964 2.825.571.812-2.261 2.6 1.7.436-3.43 4.557 2 .92-2.818 4.655 1.883 1.2-.651.934 5.902 9.328-1.667.834 2.15 3.16 1.46-2.41-2.18-1.002 3.173-4.217-1.893-.485 3.165-3.64-.492-.7.496-.712-.76-1.09 1.905-1.214-3.264-5.8 2.21-.158-2.567-3.776 1.365-.682zm84.933 3.68l-4.583 6.592 1.035 1.472-4.63 5.325 3.269.836-6.312 8.389 3.824 1.759-1.36 2.246-.414.683-3.452 5.702 3.488 2.22-6.969 10.004-2.357 3.384 2.768.082-.247-.355.778-.6-.04.131.61-.471-.004-.007-.18.05.136-.106 1.211 1.424.217.006-2.065 3.245-.009.015-6.919 10.872 3.444 1.252-6.394 10.048 3.936.328-12 15.05 7.453-.458 20.026 2.358 9.461-14.868-5.063-1.842 11.976-18.361-7.05-1.966 9.501-13.637-3.886-5.579 3.51-2.234-5.89-10.47 4.253-.303-5.048-7.424 2.532-1.266-2.013-3.183-.219-.139.064-.105zm-33.151 1.757l-1.964 2.825.57.812-2.26 2.6 1.7.435-3.43 4.558 2 .92-2.819 4.655 1.884 1.198-4.465 6.41.284.503 2.146.063-1.12 1.762.078.138-.28.178-1.366 2.148 5.526 7.932 2.77-4.575-2.736-1.259 4.054-5.388-2.372-.607 3.888-4.473-.633-.901 1.892-2.722 1.757-2.527-2.079-3.695 2.21-.157-2.567-3.776 1.365-.682zm-70.36 3.065l-1.683 2.42.521.742L77.8 56.27l1.532.392-3.12 4.147 1.804.83-2.561 4.229 1.711 1.09-4.318 6.197 2.503.074-1.954 3.07.69 1.139-2.377 1.513-.828 1.3 1.666.607-1.635 2.57 7.274 10.442.25.03 2.183-3.134-1.55.095 4.915-6.162-1.688-1.074 3.433-5.67-2.736-1.258 4.054-5.388-2.373-.607 1.538-1.77-1.376-1.975 1.733-1.103-2.982-5.3 1.991-.143-2.3-3.384 1.238-.62zm38.897.953l-1.964 2.825.571.813-2.261 2.6 1.7.435-3.43 4.558 2 .92-2.502 4.131.869 1.278.698.443-.2.288.546.804.474.697-2.173.155-.171.245 2.628 4.672-1.772 1.129 4.654 6.68 5.833-8.372-2.285-1.454 2.113-3.489-.944-1.354 1.704-1.085-2.176-1 1.079-1.435-1.966-3.493 2.21-.158-2.566-3.775 1.364-.683zm13.62.57l-2.765 3.975.713 1.013-2.985 3.433 2.18.558-3.812 5.066-.498.662 1.175.54 1.381.637-.53.876.006.013-.023.015-1.174 1.938-1.833 3.027 2.374 1.511-6.185 8.879 3.526.104-4.445 6.985-.683 1.072-1.027 1.615 2.329.847-4.266 6.704 2.72.226-5.11 6.41-2.68 3.36.193.303 4.01-.247 14.3 1.684-.452 5.22h7.184l-.454-5.253 2.308-.178 3.83-6.017-2.33-.848 5.702-8.96-3.673-.107 3.5-5.023.476-.685-3.93-6.026 3.194-.89-6.391-9.175 2.395-1.524-4.066-7.228 2.834-.202-3.325-4.89 1.721-.861zm-25.32 6.952l-.187.27.054.095-.217.139-1.614 2.32.571.813-2.261 2.6 1.7.435-3.43 4.558 2 .92-2.804 4.63.042.061 1.827 1.163-2.366 3.396 1.668 2.965-1.588 1.01-.465.731 6.526 9.369-3.265.91 5.511 8.45-2.34.85 3.212 5.047-.252-2.913 3.225-.25 2.745-3.442-2.362-.196 4.627-7.271-2.329-.848 2.528-3.972-3.877-5.945 2.514-.7-5.01-7.191 1.906-1.213-2.371-4.214-.893-1.586 2.102-.15.108-.009-2.567-3.775 1.365-.682zm62.179 1.504l-1.964 2.825.57.812-2.26 2.6 1.699.436-3.429 4.558 2 .92-1.812 2.991 2.39 3.515-2.07.147-.59.846 3.123 5.55-1.515.965.505.795-.974.08 1.356 1.948 5.642-8.098-3.4-2.164 4.202-6.938-.45-.797.975-.07.38-.626-4.004-1.84 2.702-3.592zm-77.644.57l-2.764 3.975.713 1.013-2.985 3.433 2.18.558-4.31 5.728 2.556 1.176-3.554 5.87 2.374 1.511-4.197 6.025-1.988 2.854 3.526.104-2.987 4.694 2.833 4.067-5.524.162-.477.749 2.33.847-1.721 2.704 9.944 15.624.943.111-.451 5.22h7.184l-.455-5.252 14.408-1.115 4.097-1.125-5.4-6.353-.959.06.488-.612-.43-.506-1.548-1.82 2.78-.232-4.266-6.704 2.318-.843-5.605-8.594 3.194-.89-5.545-7.96-.236-.339-.934-1.34 1.006.03 1.713-1.09-.515-.916-.895-1.591-2.656-4.72 2.835-.203-3.326-4.89 1.722-.861zm64.853 2.34l-2.764 3.975.713 1.014-2.985 3.433 2.179.557-4.31 5.728 2.558 1.176-3.555 5.87 2.374 1.511-3.313 4.755-1.014 1.456-1.857 2.668 3.526.104-6.155 9.672 2.328.847-4.265 6.704.045.004.018.001 2.656.221-8.053 10.1 4.467-.274 14.3 1.683-.391 4.517 6-7.524-3.58-.298 6.756-10.616-3.444-1.252 7.46-11.722-.64-.982 1.537-.428.182-.286-5.395-.159 2.757-3.958.683-.98-2.962-4.253.852-.542.648-.413.694-.442.201-.128-4.066-7.227 2.834-.203-3.324-4.89 1.72-.86zm40.177 12.887l1.655 2.943-3.377 2.15 2.558 3.673 3.974-5.704zm-97.014.66l-1.126.08.994 1.768.932-1.338-.406-.259-.07.115-.19-.28zm17.779 8.679l-.848.236 2.243 3.44 2.205-3.463-3.673-.109zm28.772.126l-2.127.593 2.341 3.589 1.953-2.803zm-68.234 9.046l1.212 1.741 1.066-1.674zm100.35 43.147l-.495 5.713 4.569-5.373z",fill:"#173d10"}),Fe=function(e){var t=e.svgRef,n=e.title,a=Ue(e,["svgRef","title"]);return o.a.createElement("svg",Ge({width:1024,height:768,viewBox:"0 0 270.933 203.2",ref:t},a),n?o.a.createElement("title",null,n):null,ze)},We=o.a.forwardRef((function(e,t){return o.a.createElement(Fe,Ge({svgRef:t},e))})),He=(n.p,n(91),function(){return o.a.createElement("div",{className:"page--404"},o.a.createElement("h1",null,"Das war die Falsche Abzweigung"),o.a.createElement(We,null),o.a.createElement("p",null,"Du scheinst dich ein wenig im Wald verrirrt zu haben. Diese Seite exisitiert leider nicht."),o.a.createElement("p",null,"Geh doch einfach nochmal eine Seite zur\xfcck und versuchs mit einer anderen Abzweigung."))});n(92);function Je(e){var t=e.images,n=(void 0===t?[]:t).map((function(e,t){return o.a.createElement("img",{src:e.src,key:t,alt:e.alt})}));return o.a.createElement("div",{className:"chat__images"},n)}n(65);function Ke(e){var t=e.message,n=e.sender,a=e.tags,r=void 0===a?{}:a,i=["chat_message"],c="SENSI";"SENDER_IS_PLAYER"===n?(i.push("chat_message--own"),c="<SPIELERNAME>"):i.push("chat_message--others");var u=o.a.createRef(),s="";"audio"in r&&(console.log("has audio"),s=o.a.createElement("audio",{ref:u,src:r.audio,controls:!0}));var l=[];return"images"in r&&(l=r.images),o.a.createElement("div",{className:i.join(" ")},o.a.createElement("h5",{className:"chat_message__sender"},c),o.a.createElement("div",{className:"chat_message__message"},o.a.createElement("p",null,t),s,o.a.createElement(Je,{images:l})))}function Ye(e){return e.chat.messageQueue}function Be(e){return e.chat.lastRead}var Qe=Object(me.a)([Be],(function(e){return e})),Ve=Object(me.a)([Be,Ye],(function(e,t){return t.length-(e+1)})),Xe=Object(me.a)([Ye],(function(e){return e})),qe=Object(me.a)([function(e){return e.chat.chatOptions}],(function(e){return e})),$e=Object(l.c)((function(e){return{messages:Xe(e),chatOptions:qe(e),lastReadIndex:Qe(e)}}),(function(e){return{markMessagesRead:function(t){return e({type:"MARK_MESSAGE_READ",index:t})}}}))((function(e){var t=e.messages,n=e.chatOptions,a=e.lastReadIndex,i=e.markMessagesRead,c=Object(r.useRef)(null);return Object(r.useEffect)((function(){c.current.children.length>0&&c.current.children[a].scrollIntoView({block:"end",behavior:"smooth"}),a<t.length-1&&i(t.length-1)}),[t,n]),o.a.createElement("div",{className:"chat"},o.a.createElement("section",{ref:c,className:"message_board"},t.map((function(e,t){return o.a.createElement(Ke,Object.assign({key:t},e))}))))}));var Ze=Object(l.c)((function(e){return{chatOptions:qe(e)}}),(function(e){return{onSendMessage:function(t){return e(te(t))}}}))((function(e){var t=e.onSendMessage,n=e.chatOptions.map((function(e){return o.a.createElement("button",{key:e.index,className:"chat_toolbar__option",onClick:function(){return t(e.index)}},e.text)}));return o.a.createElement("div",{className:"toolbar chat_toolbar"},n)}));var et=Object(l.c)((function(e){return{unreadMessageCount:Ve(e)}}),(function(e){return{}}))((function(e){var t=e.unreadMessageCount,n=["header__button","header__button_chat"],a=o.a.createElement("span",null,"Chat");return t>0&&(n.push("header__button_chat--unread"),a=o.a.createElement("span",null," Chat ",o.a.createElement("span",{class:"header__button_chat__count"},t)," Ungelesene Nachrichten ")),o.a.createElement(Pe.a,{to:"/chat",className:n.join(" ")},a)}));function tt(){return o.a.createElement(Me.c,null,o.a.createElement(Me.a,{path:"/chat",component:Ze}),o.a.createElement(Me.a,null,o.a.createElement("div",{className:"empty-toolbar"})))}n(93);function nt(e){return e.geolocation.currentLocation}var at=Object(me.a)([nt],(function(e){return e.latitude})),rt=Object(me.a)([nt],(function(e){return e.longitude})),ot=Object(me.a)([nt],(function(e){return{lat:e.latitude,long:e.longitude}}));var it,ct=Object(me.a)([function(e){console.log(e.resources.stations);try{return Object.values(e.resources.stations)}catch(t){return[]}}],(function(e){return e})),ut=Object(l.c)((function(e){return{position:ot(e),stations:ct(e),state:JSON.stringify(e,null,"  ")}}),(function(e){return{}}))((function(e){var t=e.position,n=e.stations,a=e.state;return console.log(a),o.a.createElement("div",{className:"dev"},o.a.createElement("div",{className:"position"},o.a.createElement("div",{className:"dev__label"},"Position"),o.a.createElement("div",{className:"dev__data"},t.lat," , ",t.long)),o.a.createElement("div",{className:"dev--stations"},o.a.createElement("div",{className:"dev__label"},"Stations"),o.a.createElement("div",{className:"dev__data"},n.map((function(e){return o.a.createElement("div",{className:"station"},o.a.createElement("strong",null,e.station,":")," ",e.latitude,", ",e.longitude)})))),o.a.createElement("div",{className:"state"},o.a.createElement("div",{className:"dev__label"},"State Data"),o.a.createElement("div",{className:"dev__data"},o.a.createElement("pre",null,a))))}));n(94);var st=(it={},Object(h.a)(it,"MESSAGE_TYPE_ERROR","message--error"),Object(h.a)(it,"MESSAGE_TYPE_LOG","message--log"),Object(h.a)(it,"MESSAGE_TYPE_SUCCESS","message--success"),it);var lt=Object(me.a)([function(e){return Object.values(e.messages.byUuid)}],(function(e){return e.filter((function(e){return!e.hide&&e.timestamp+3e3>=Date.now()})).sort((function(e,t){return e-t})).slice(-3)})),dt=Object(l.c)((function(e){return{messages:lt(e)}}),(function(e){return{onMessageRead:function(t){return e(K(t))}}}))((function(e){var t=e.messages,n=e.onMessageRead;return o.a.createElement("div",{className:"message_display"},t.map((function(e,t){return o.a.createElement("div",{key:e.uuid,className:["card","message",st[e.messageType]].join(" "),onClick:function(){return n(e.uuid)}},e.text)})))}));var ft={latitude:{min:50.82113813164011,max:50.85731159369495},longitude:{min:8.630602108424023,max:8.701868299964586}};function mt(e,t){var n=t.latitude,a=t.longitude;(function(e,t){return e>=ft.latitude.min&&e<=ft.latitude.max&&t>=ft.longitude.min&&t<=ft.longitude.max})(n,a)&&"setPositionMarker"in e.current.contentWindow&&(console.log("SET POSITION"),e.current.contentWindow.setPositionMarker(n,a))}var pt=Object(l.c)((function(e){return{latitude:at(e),longitude:rt(e)}}),(function(e){return{}}))((function(e){var t=Object(r.useRef)(null);return Object(r.useEffect)((function(){t.current.loaded?mt(t,e):t.current.addEventListener("load",(function(){console.log("iframe loaded"),t.current.loaded=!0,mt(t,e)}))})),o.a.createElement("div",null,o.a.createElement("iframe",{ref:t,id:"mapIframe",title:"Map Iframe",width:"1000",height:"1000",src:"./assets/map/index.html"}))}));n(95),n(96);var gt=function(e){var t=e.clearButton;return o.a.createElement("div",{className:"App"},o.a.createElement("header",{className:"App-header"},o.a.createElement(Pe.a,{to:"/"},"SENSO-Trail App"),o.a.createElement("nav",{className:"nav"},o.a.createElement(Pe.a,{to:"/map",className:"header__button header__button_map"},"Map"),o.a.createElement(et,null)),o.a.createElement(dt,null)),o.a.createElement("main",null,o.a.createElement(Me.c,null,o.a.createElement(Me.a,{exact:!0,path:"/",render:function(){return function(e){return o.a.createElement("div",{className:"dummy_front_page"},o.a.createElement(Pe.a,{to:"/chat"},"GOTO Chat"),o.a.createElement(Pe.a,{to:"/map"},"GOTO Map"),o.a.createElement(Pe.a,{to:"/dev"},"Dev"),o.a.createElement("button",{onClick:function(){var e=["/assets/images/Saftfluss.jpg","/assets/images/TreeTalker.jpg"];window.navigator.serviceWorker.controller.postMessage({type:"NATURE40_ADD_ROUTE",routes:e}),Promise.all(e.map((function(e){return fetch(e)})))}}," Test: Precache Saftfluss.jpg "),e||"")}(t)}}),o.a.createElement(Me.a,{exact:!0,path:"/chat",component:$e}),o.a.createElement(Me.a,{exact:!0,path:"/map",component:pt}),o.a.createElement(Me.a,{exact:!0,path:"/dev",component:ut}),o.a.createElement(Me.a,{component:He}))),o.a.createElement(tt,null))};function vt(){return console.log("Geolocation available:","geolocation"in window.navigator),"geolocation"in window.navigator}var Ot=void 0;function Et(){navigator.geolocation.clearWatch(Ot),Ot=void 0}var ht={init:function(e){Ot&&console.error("A watcher is already defined"),vt()&&(Ot=navigator.geolocation.watchPosition((function(t){var n,a;console.log("onLocationChanged:"),e((n=t.coords.latitude,a=t.coords.longitude,{type:"GEOLOCATION_CHANGED",latitude:n,longitude:a}))}),(function(t){e(function(e){return{type:"GEOLOCATION_ERROR",error:e}}(t)),Et()})))},clear:Et,isAvailable:vt};var bt=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)),_t=function(){return console.log("registered")};function St(e,t){return navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}function jt(e,t){fetch(e).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):St(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}var At,Tt=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,n={key:"root",storage:E.a,blacklist:["router"]};e=Object(v.a)(n,x(ke));var a=De(),r=[a,Object(g.a)(ke)],o=Object(p.e)(e,t,Le(p.a.apply(void 0,r)));return a.run(xe),{store:o,persistor:Object(v.b)(o)}}(),yt=Tt.store,Nt=Tt.persistor,wt=((At="/SENSO-Trail-App")||(At="/"),At.endsWith("/")||(At+="/"),console.log("base: ",At),u.sources={trail:"".concat(At,"assets/trails/"),audio:"".concat(At,"assets/audio/"),image:"".concat(At,"assets/images/")},console.log(u),u.trailname="trail",u);ht.init(yt.dispatch);var Rt=o.a.createElement("button",{onClick:function(){console.log("START CLEARING"),Promise.all([window.caches.keys().then((function(e){var t,n=Object(a.a)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;window.caches.delete(r)}}catch(o){n.e(o)}finally{n.f()}})).then((function(){console.log("Service Worker cleared")})),Nt.purge().then((function(){console.log("Persist store cleared")}))]).then((function(){console.log("all caches cleared"),window.location.reload()}))}},"Clear Caches");c.a.render(o.a.createElement(l.a,{store:yt},o.a.createElement(d.a,{history:ke,basename:"/SENSO-Trail-App"},o.a.createElement(f.a,{loading:null,persistor:Nt},o.a.createElement(gt,{clearButton:Rt})))),document.getElementById("root")),console.log("prod env"),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_t;if("serviceWorker"in navigator){var n=new URL("/SENSO-Trail-App",window.location.href);if(n.origin!==window.location.origin)return;window.addEventListener("load",(function(){var n="".concat("/SENSO-Trail-App","/service-worker.js");bt?(jt(n,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA"),t()}))):St(n,e).then(t)}))}}({},(function(){yt.dispatch(function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return{type:"SET_SW_ACTIVE",active:e}}()),yt.dispatch({type:"LOAD_INK_JSON_START",filename:"".concat(wt.sources.trail).concat(wt.trailname,".json")})}))}},[[75,1,2]]]);
//# sourceMappingURL=main.0effc8f2.chunk.js.map